<AppChat>:
	orientation:"vertical"
	
	MenuActionBar:
	    id:"menubar"
	    
	ScreenManager:
		id:sm
		MenuScreen:
		MessagesScreen:

<MenuActionBar@ActionBar>
	pos_hint: {'top':1}
	ActionView:
		use_separator: True
        ActionPrevious:
            title: 'App'
            with_previous: False
        ActionButton:
            text: 'Disconnect'
            on_press:
            	app.root.ids.sm.transition.direction = 'right'
            	app.root.ids.sm.current='menu'
        ActionGroup:
            text: 'Settings' 
            mode: 'spinner'
            ActionButton:
                text: 'Group'
            ActionButton:
                text: 'System'
                on_press: app.open_settings()
            ActionButton:
                text: 'Custom'
            ActionButton:
                text: 'Infos'
            ActionButton:
            	text:'Quit'
            	on_press: app.get_running_app().stop()

<MessagesScreen>
	name:"messages"
    BackgroundScroller:
    	id:scroller
    	GridLayout:
    		size_hint:(1,None)
    		height:self.minimum_height
    		id:messages
    		cols:1
        
    BoxLayout:
    	orientation:"horizontal"
    	size_hint:(1,None)
    	size:(1,120)
    	TextInput:
    		id:textbox
    		text:""
    		hint_text:"message"
    		font_size:60
    		keyboard_suggestions:False
    		padding_y: [self.height / 2.0 - (self.line_height / 2.0) * len(self._lines), 0]
    		multiline:False
    		cursor_color:(0,0,0,0)
    		hint_text_color:(0.5,0.5,0.5,0.4)
    	SendButton:
    		on_press: root.sendMessage()
    		
<MenuScreen>
	name:"menu"
	BoxLayout:
		orientation:"vertical"
		BoxLayout:
			orientation:"vertical"
			Label:
				text:"Join a room"
			BoxLayout:
				orientation:"horizontal"
				Label:
					text:"Name"
				TextInput:
			BoxLayout:
				orientation:"horizontal"
				Label:
					text:"Ip"
				TextInput:
			BoxLayout:
				orientation:"horizontal"
				Label:
					text:"Port"
				TextInput:
			Button:
				text:"Join Room"
				on_press: 
					app.root.ids.sm.transition.direction = 'left'
					app.root.ids.sm.current = "messages"
		BoxLayout:
			orientation:"vertical"
			Label:
				text:"Create a room"
			BoxLayout:
				orientation:"horizontal"
				Label:
					text:"Name"
				TextInput:
			BoxLayout:
				orientation:"horizontal"
				Label:
					text:"Limit"
				TextInput:
			BoxLayout:
				orientation:"horizontal"
				Label:
					text:"Port"
				TextInput:
			Button:
				text:"Create Room"
				on_press: 
					app.root.ids.sm.transition.direction = 'left'
					app.root.ids.sm.current = "messages"
			
		
<BackgroundColor@Widget>
    background_color:(1, 1, 1, 1)
    canvas.before:
        Color:
            rgba: root.background_color
        Rectangle:
            size: self.size
            pos: self.pos
            
<BackgroundLabel@Label+BackgroundColor>
    background_color:(0, 0, 0, 0)

<Message@BackgroundLabel>
	padding_x:50
	padding_y:30
	valign:'bottom'
	halign:'left'
	text_size:(self.width, None)
    size_hint:(1, None)
    height: self.texture_size[1]
	
<SendMessage@Message>
	color:(self.fnt_r, self.fnt_g, self.fnt_b, self.fnt_a)
	background_color:(self.bkg_r, self.bkg_g, self.bkg_b, self.bkg_a)
	
<RecvMessage@Message>
	background_color:(0.1, 0.4, 0.6, 1)
	
<SysMessage@Message>
	halign:'center'
	background_color:(0.1, 0.4, 0.6, 1)
	
<SendButton@Button>
	text: "Send"
	size_hint:(0.2,1)
	color:(self.fnt_r, self.fnt_g, self.fnt_b, self.fnt_a)
	background_color:(self.bkg_r, self.bkg_g, self.bkg_b, self.bkg_a)
	
<BackgroundScroller@ScrollView+BackgroundColor>
	effect_cls:"OpacityScrollEffect"
    do_scroll_x:False
    do_scroll_y:True
    background_color:(self.bkg_r, self.bkg_g, self.bkg_b, self.bkg_a)
